# Java多线程安全

## Java多线程安全概念

​       从某个线程开始访问到访问结束的整个过程，如果有一个访问对象被其他线程修改，那么对于当前线程而言就发生了线程安全问题；如果在整个访问过程中，无一对象被其他线程修改，就是线程安全的。

​       多线程应用程序同时访问共享对象时，由于线程间互相抢占CPU的控制权，造成一个线程夹在另一个线程的执行过程中运行，所以可能导致错误的执行结果。



1. 线程安全问题存在的原因:

   由于一个线程在操作共享数据过程中，未执行完毕的情况下，另外的线程参与进来，导致共享数据存在安全问题。

2. 如何解决线程的安全问题

必须让一个线程操作共享数据完毕后，其他线程才有机会参与共享数据的操作。

3.java如何实现线程的安全:线程的同步机制

方式一: 同步代码块:



```java
synchronized(同步监视器){
   //需要被同步的代码块
}
```

1. 共享数据: 多个线程共同操作的同一个数据(变量)

2. 同步监视器，由一个对象来充当哪个线程获取此监视器，谁就执行大括号里被同步的代码。俗称:锁

   要求:所有线程必须公用同一把锁！

   注意: 在实现的方式中，考虑同步可以使用this来充当锁。但是在继承的方式中，慎用this(this是唯一的可以用，this不唯一不能用)

方式二：同步方法

将操作共享数据的方法声明为synchronized。即此方法为同步方法，能够保证当其中一个线程执行此方法时，其它线程在外等待知道此线程执行完此方法。 

```java
 
```





### 何时需要多线程

* 程序需要同时执行2个或者以上任务时
* 程序需要实现一些需要等待的任务时，如用户输入，文件读写操作，网络操作。搜索等
* 需要一些后台运行的程序时

### 产生线程安全的条件

同时满足以下两个条件时：

* 多个线程在操作共享的数据。
* 操作共享数据的线程代码有多条。

多线程的优点

背景: 只是用单个线程完成多个任务(调用多个方法)，肯定比用多个线程来完成用的时间更短，为何仍需多线程呢？



多线程程序的优点:

1. 提高应用程序的相应，对图形化界面更有意义，可增强用户体验
2. 提供计算机系统CPU的利用率
3. 改善程序结构。将既长又复杂的进程分为多个线程，独立运行，利于理解和修改。



互斥锁

在Java语言中，引入了对象互斥锁的概念，来保证共享数据操作的完整性。

> 每个对象都对应于一个可称为"互斥锁"的标记，这个标记来保证在任一时刻，只能有一个线程访问该对象

> 关键字synchronized来与对象的互斥锁联系。当某个对象用synchronized修饰时，表明该对象在任一时刻只能由一个线程访问。

> 同步的局限性：导致程序的执行效率要降低

> 非静态同步方法的锁可以是this

> 静态同步方法的锁可以为当前类本身。

线程的死锁问题

死锁： 

不同的线程分别占用对象需要的同步资源不放弃，都在等待对方放弃自己需要的同步资源，j就形成了线程的死锁。

解决方法:

* 专门的算法，原则
* 尽量减少同步资源的定义

## Java多线程解决方法

## Java多线程解决方法优缺点

